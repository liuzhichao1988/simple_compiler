# Virtual Machine

## 内存

+——————————+

| stack | |

| …  ...v |

| …  ..^ |

| heap | |

+——————————+

| bss segment |

+——————————+

| data segment |

+——————————+

| text segment |

+——————————+

1.text存放代码（指令）
2.data 存放初始化了的数据，如 int i = 10;
3.未初始化数据段（bss）用于存放未初始化的数据，如 int i[1000]; 因为不关心其中的真正数值，所以单独存放以节省空间
4.stack 用于处理函数调用数据，如 calling frame 和 函数的局部变量
5.heap 用于为程序动态分配内存

**该虚拟机只为了解基础工作原理，因此只关心代码段、数据段以及栈**

## 寄存器

为了简化，只提供了四个寄存器：
1. pc 程序寄存器
2. sp 指针寄存器
3. bp 基地址指针
4. ax 通用寄存器

## 指令集
### 基础指令
为了操作简单，基础指令最多只传递一个参数，将传统的MOV指令拆分成了LC、LI、SC、SI四个指令

### 函数调用
由于只能操作ax一个通用寄存器，因此为函数调用拓展了 ENT、ADJ、LEV、LEA指令，理解这些指令的操作只需要弄清楚指令集的结构即可


### 运算符指令
第一个参数放在栈顶，第二个参数放在ax，计算后，栈顶参数退栈，结果放入ax

### 内置函数
内置函数的指令直接调用了c语言提供的方法
